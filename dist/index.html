<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BGP Simulator</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #004E89 0%, #003a5f 100%);
            color: #2C3E50;
            min-height: 100vh;
            padding: 20px;
        }

        .container { max-width: 1200px; margin: 0 auto; }

        header {
            background: white;
            padding: 40px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }

        h1 { font-size: 2.5em; color: #FF6B35; margin-bottom: 10px; }
        .subtitle { color: #7F8C8D; font-size: 1em; margin-top: 10px; }

        .section {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: #004E89;
            font-size: 1.5em;
            margin-bottom: 20px;
            border-left: 4px solid #FF6B35;
            padding-left: 15px;
        }

        .file-upload-area {
            border: 2px dashed #1AC8ED;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(26, 200, 237, 0.05);
            margin-bottom: 20px;
        }

        .file-upload-area:hover {
            background: rgba(26, 200, 237, 0.1);
            border-color: #FF6B35;
        }

        .file-upload-area input[type="file"] {
            display: none;
        }

        .file-upload-label {
            display: block;
            cursor: pointer;
            color: #004E89;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .file-info {
            color: #7F8C8D;
            font-size: 0.9em;
            margin-top: 10px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            color: #004E89;
            font-weight: 600;
            margin-bottom: 10px;
        }

        input[type="text"], input[type="file"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #E0E0E0;
            border-radius: 6px;
            font-size: 1em;
            font-family: monospace;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #1AC8ED;
            box-shadow: 0 0 0 3px rgba(26, 200, 237, 0.1);
        }

        button {
            background: #FF6B35;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            width: 100%;
        }

        button:hover { background: #e55a24; transform: translateY(-2px); }
        button:disabled { opacity: 0.5; cursor: not-allowed; }

        .status-message {
            padding: 12px 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            display: none;
        }

        .status-message.show {
            display: block;
        }

        .status-message.success {
            background: #D4EDDA;
            color: #155724;
            border: 1px solid #C3E6CB;
        }

        .status-message.error {
            background: #F8D7DA;
            color: #721C24;
            border: 1px solid #F5C6CB;
        }

        .status-message.info {
            background: #D1ECF1;
            color: #0C5460;
            border: 1px solid #BEE5EB;
        }

        .results {
            background: #F8F9FA;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #2ECC71;
            display: none;
        }

        .results.show {
            display: block;
        }

        .stat {
            display: inline-block;
            background: linear-gradient(135deg, #1AC8ED 0%, #004E89 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 6px;
            margin: 10px 10px 10px 0;
            text-align: center;
        }

        .stat-value { font-size: 1.8em; font-weight: 700; }
        .stat-label { font-size: 0.9em; opacity: 0.9; }

        .data-preview {
            background: #F8F9FA;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 0.85em;
            font-family: monospace;
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
            border-left: 4px solid #1AC8ED;
        }

        footer {
            background: white;
            padding: 20px;
            text-align: center;
            border-radius: 12px;
            color: #7F8C8D;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>BGP Simulator</h1>
            <p>Autonomous System Routing Simulation</p>
            <p class="subtitle">Upload your network data to analyze</p>
        </header>

        <main>
            <section class="section">
                <h2>Upload Network Data</h2>

                <div id="status-message" class="status-message"></div>

                <form id="upload-form">
                    <div class="form-group">
                        <label class="form-label">CAIDA AS Relationships File</label>
                        <div class="file-upload-area" id="caida-upload">
                            <label class="file-upload-label">Click to select or drag and drop</label>
                            <input type="file" id="caida-file" accept=".txt,.csv">
                            <div class="file-info">Format: ASN1|ASN2|relationship (one per line)</div>
                        </div>
                        <div id="caida-status" style="color: #7F8C8D; font-size: 0.9em;"></div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">BGP Announcements File</label>
                        <div class="file-upload-area" id="announcements-upload">
                            <label class="file-upload-label">Click to select or drag and drop</label>
                            <input type="file" id="announcements-file" accept=".csv,.txt">
                            <div class="file-info">Format: CSV with origin_asn,prefix,rov_invalid</div>
                        </div>
                        <div id="announcements-status" style="color: #7F8C8D; font-size: 0.9em;"></div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ROV ASNs File (Optional)</label>
                        <div class="file-upload-area" id="rov-upload">
                            <label class="file-upload-label">Click to select or drag and drop</label>
                            <input type="file" id="rov-file" accept=".txt,.csv">
                            <div class="file-info">Format: One ASN per line</div>
                        </div>
                        <div id="rov-status" style="color: #7F8C8D; font-size: 0.9em;"></div>
                    </div>

                    <button type="submit" id="analyze-button">Analyze Data</button>
                </form>

                <div id="results-section" class="results">
                    <h3 style="color: #004E89; margin-bottom: 15px;">Data Analysis</h3>

                    <div id="stats-container" style="margin-bottom: 20px;"></div>

                    <div>
                        <h4 style="color: #004E89; margin-top: 20px; margin-bottom: 10px;">AS Relationships Preview</h4>
                        <div id="topology-preview" class="data-preview"></div>
                    </div>

                    <div>
                        <h4 style="color: #004E89; margin-top: 20px; margin-bottom: 10px;">Announcements Preview</h4>
                        <div id="announcements-preview" class="data-preview"></div>
                    </div>
                </div>
            </section>

            <section class="section">
                <h2>About BGP</h2>
                <p style="line-height: 1.8; color: #555;">
                    The Border Gateway Protocol (BGP) is the routing protocol used on the internet to exchange routing information between autonomous systems (ASes).
                    This simulator analyzes how different network topologies and announcements affect route propagation.
                </p>
                <p style="line-height: 1.8; color: #555; margin-top: 10px;">
                    Upload your CAIDA AS relationships and BGP announcements files to analyze your network topology.
                </p>
            </section>
        </main>

        <footer>
            <p>BGP Simulator v1.0 | <a href="https://github.com/ajimenezvargas/3150-final-project" style="color: #FF6B35; text-decoration: none;">GitHub</a></p>
        </footer>
    </div>

    <script>
        let caidaData = '';
        let announcementsData = '';
        let rovData = '';

        function showStatus(message, type) {
            const statusDiv = document.getElementById('status-message');
            statusDiv.textContent = message;
            statusDiv.className = 'status-message show ' + type;

            if (type === 'success') {
                setTimeout(() => {
                    statusDiv.classList.remove('show');
                }, 5000);
            }
        }

        function setupFileUpload(uploadAreaId, inputId, statusId) {
            const uploadArea = document.getElementById(uploadAreaId);
            const input = document.getElementById(inputId);
            const status = document.getElementById(statusId);

            uploadArea.addEventListener('click', () => input.click());

            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = '#FF6B35';
                uploadArea.style.background = 'rgba(255, 107, 53, 0.05)';
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.style.borderColor = '#1AC8ED';
                uploadArea.style.background = 'rgba(26, 200, 237, 0.05)';
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = '#1AC8ED';
                uploadArea.style.background = 'rgba(26, 200, 237, 0.05)';
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    input.files = files;
                    handleFileSelect(input, statusId, uploadAreaId);
                }
            });

            input.addEventListener('change', () => {
                handleFileSelect(input, statusId, uploadAreaId);
            });
        }

        function handleFileSelect(input, statusId, uploadAreaId) {
            const file = input.files[0];
            if (!file) return;

            const status = document.getElementById(statusId);
            const uploadArea = document.getElementById(uploadAreaId);
            const size = (file.size / 1024).toFixed(2);

            const reader = new FileReader();
            reader.onload = (e) => {
                const content = e.target.result;

                if (uploadAreaId === 'caida-upload') {
                    caidaData = content;
                    status.textContent = `✓ Loaded (${size} KB)`;
                } else if (uploadAreaId === 'announcements-upload') {
                    announcementsData = content;
                    status.textContent = `✓ Loaded (${size} KB)`;
                } else if (uploadAreaId === 'rov-upload') {
                    rovData = content;
                    status.textContent = `✓ Loaded (${size} KB)`;
                }

                status.style.color = '#28A745';
                uploadArea.style.borderColor = '#1AC8ED';
                uploadArea.style.background = 'rgba(26, 200, 237, 0.05)';
            };

            reader.onerror = () => {
                status.textContent = 'Error reading file';
                status.style.color = '#DC3545';
            };

            reader.readAsText(file);
        }

        document.getElementById('upload-form').addEventListener('submit', (e) => {
            e.preventDefault();

            if (!caidaData) {
                showStatus('Please upload CAIDA AS relationships file', 'error');
                return;
            }

            if (!announcementsData) {
                showStatus('Please upload announcements CSV file', 'error');
                return;
            }

            analyzeData();
        });

        function analyzeData() {
            try {
                // Parse CAIDA data
                const caidaLines = caidaData.split('\n').filter(l => l.trim() && !l.startsWith('#'));
                const ases = new Set();
                const relationships = [];

                caidaLines.forEach(line => {
                    const parts = line.split('|');
                    if (parts.length >= 3) {
                        ases.add(parts[0].trim());
                        ases.add(parts[1].trim());
                        relationships.push(line.trim());
                    }
                });

                // Parse announcements data
                const annLines = announcementsData.split('\n').filter(l => l.trim());
                const announcements = [];
                let isHeader = true;

                annLines.forEach(line => {
                    if (isHeader && (line.includes('origin') || line.includes('asn'))) {
                        isHeader = false;
                        return;
                    }
                    if (line.trim()) {
                        announcements.push(line.trim());
                    }
                });

                // Count origin ASNs
                const originAsns = new Set();
                announcements.forEach(line => {
                    const parts = line.split(',');
                    if (parts.length >= 1) {
                        originAsns.add(parts[0].trim());
                    }
                });

                // Display stats
                const statsHtml = `
                    <div class="stat">
                        <div class="stat-value">${ases.size}</div>
                        <div class="stat-label">Autonomous Systems</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value">${relationships.length}</div>
                        <div class="stat-label">Relationships</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value">${announcements.length}</div>
                        <div class="stat-label">Announcements</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value">${originAsns.size}</div>
                        <div class="stat-label">Origin ASNs</div>
                    </div>
                `;
                document.getElementById('stats-container').innerHTML = statsHtml;

                // Show data previews
                const topologyPreview = document.getElementById('topology-preview');
                topologyPreview.textContent = relationships.slice(0, 10).join('\n') +
                    (relationships.length > 10 ? `\n... and ${relationships.length - 10} more relationships` : '');

                const announcementsPreview = document.getElementById('announcements-preview');
                announcementsPreview.textContent = announcements.slice(0, 10).join('\n') +
                    (announcements.length > 10 ? `\n... and ${announcements.length - 10} more announcements` : '');

                document.getElementById('results-section').classList.add('show');
                showStatus('Data analyzed successfully!', 'success');
                document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });

            } catch (error) {
                showStatus('Error analyzing data: ' + error.message, 'error');
            }
        }

        // Setup file uploads
        setupFileUpload('caida-upload', 'caida-file', 'caida-status');
        setupFileUpload('announcements-upload', 'announcements-file', 'announcements-status');
        setupFileUpload('rov-upload', 'rov-file', 'rov-status');
    </script>
</body>
</html>
